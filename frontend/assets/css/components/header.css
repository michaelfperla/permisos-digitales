/* === Header Component Styles === */
/* Professional, modern styling for the main navigation header */

/* Header animations */
@keyframes header-shadow {
  from { box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05); }
  to { box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); }
}

@keyframes logo-pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

.app-header {
    background-color: var(--color-white);
    padding: var(--spacing-sm) 0;
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 100;
    transition: transform 0.3s ease-in-out, opacity 0.25s ease-in-out, box-shadow 0.3s ease;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    border-bottom: 1px solid rgba(var(--color-primary-rgb), 0.08);
}

.app-header:hover {
    animation: header-shadow 0.5s forwards;
}

/* Header hidden state - for scroll interaction */
.app-header.header-hidden {
    transform: translateY(-100%); /* Move up out of view */
}

.header-container {
    width: 100%;
    max-width: 1200px; /* Match dashboard container width */
    margin: 0 auto;
    padding: 0 var(--spacing-lg); /* Side padding */
    display: flex;
    justify-content: space-between;
    align-items: center;
    min-height: 60px; /* Slightly reduced height while still accommodating logo */
}

.header-branding {
    position: relative;
}

.header-branding .logo-link {
    display: inline-flex; /* Align logo and potential text */
    align-items: center;
    text-decoration: none;
    color: inherit;
    position: relative; /* For transition effects */
    transition: color var(--transition-duration-base) ease;
}

.header-branding .logo-link:hover {
    opacity: 0.8;
}

.header-branding .logo-link:active {
    opacity: 0.6;
}

/* Mobile Logo (Icon) */
.logo-mobile {
    height: 38px; /* Increased height for mobile logo icon */
    width: auto; /* Maintain aspect ratio */
    display: inline-block; /* Better alignment with potential text */
    vertical-align: middle; /* Align properly with any adjacent text */
}

/* Desktop Logo (Full Lockup) */
.logo-desktop {
    display: none; /* Hidden by default on mobile */
}

/* Desktop Breakpoint */
@media (min-width: 992px) {
    .logo-mobile {
        display: none; /* Hide mobile logo on desktop */
    }

    .logo-desktop {
        height: 56px; /* Increased height for desktop logo */
        width: auto; /* Maintain aspect ratio */
        display: inline-block; /* Show desktop logo */
        vertical-align: middle; /* Align properly with any adjacent text */
    }
}

/* Legacy class for backward compatibility */
.header-logo {
    height: 35px; /* Fixed height for header logo icon */
    width: auto; /* Maintain aspect ratio */
    display: inline-block; /* Better alignment with potential text */
    vertical-align: middle; /* Align properly with any adjacent text */
}

/* Site name styling */
.header-branding .site-name {
    font-size: 1.2rem;
    font-weight: var(--font-weight-bold);
    color: var(--color-primary);
    transition: color var(--transition-duration-base) ease;
    display: inline-block;
    position: relative;
}

.header-navigation {
    position: relative;
}

.header-navigation .nav-links {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    align-items: center;
    gap: var(--spacing-lg); /* Space between nav items */
}

.header-navigation .nav-link {
    text-decoration: none;
    color: var(--color-text-muted);
    font-weight: var(--font-weight-medium);
    font-size: 0.95rem;
    transition: color var(--transition-duration-base) ease,
                border-color var(--transition-duration-base) ease;
    padding: var(--spacing-xs) 0; /* Add slight vertical padding for hit area */
    border-bottom: 2px solid transparent; /* For hover effect */
    position: relative;
    display: inline-block;
}

.header-navigation .nav-link:hover,
.header-navigation .nav-link:focus-visible {
    color: var(--color-primary);
    border-bottom-color: var(--color-primary);
    text-decoration: none !important;
}

.header-navigation .nav-link.active { /* Active state without underline by default */
    color: var(--color-primary);
    font-weight: var(--font-weight-bold);
    border-bottom-color: transparent; /* Explicitly keep border transparent */
    text-decoration: none !important;
}

/* Hover on active still shows underline */
.header-navigation .nav-link.active:hover,
.header-navigation .nav-link.active:focus-visible {
    border-bottom-color: var(--color-primary);
}

.header-navigation .nav-link:active {
    color: var(--color-primary-dark);
}

/* Styling for buttons within nav - Now extends global button styles */
.header-navigation .btn-small {
     padding: var(--spacing-xs) var(--spacing-md); /* Smaller padding for header buttons */
     font-size: 0.9rem; /* Smaller font size for header buttons */
}

/* Active state for buttons */
.header-navigation .btn.active-btn {
     /* No additional styles needed - the base .btn-primary already has the correct styling */
     /* This class is just for tracking the active state in JavaScript */
}


/* User info display */
.nav-user-info {
    color: var(--color-text);
    font-size: 0.95rem;
}
.nav-user-info #user-name-display {
    font-weight: var(--font-weight-medium);
    color: var(--color-primary);
}

/* Logout button needs to look like a link/button */
#header-logout-btn {
    /* Inherit .nav-link for base style, then add button specifics */
    background: none;
    border: none;
    cursor: pointer;
    padding: var(--spacing-xs) 0; /* Match link padding */
    margin: 0;
    /* Or style it like a secondary button */
    /* border: 1px solid var(--color-secondary); */
    /* border-radius: var(--border-radius-md); */
    /* padding: var(--spacing-xs) var(--spacing-md); */
}
 #header-logout-btn:hover {
    color: var(--color-primary-dark); /* Match link hover */
    /* background-color: rgba(var(--color-secondary-rgb), 0.1); */ /* If styled as button */
 }

/* Button that looks like a link */
.btn-like-link {
    background: none;
    border: none;
    padding: 0;
    margin: 0;
    cursor: pointer;
    color: var(--color-text-muted); /* Match link color */
    font-weight: var(--font-weight-medium);
    font-size: 0.95rem;
    font-family: inherit; /* Ensure correct font */
    border-bottom: 2px solid transparent; /* Match link hover */
    transition: color var(--transition-duration-base) ease,
                border-color var(--transition-duration-base) ease;
    position: relative;
    display: inline-block;
}

.btn-like-link:hover {
    color: var(--color-primary); /* Match link hover */
    text-decoration: none; /* Remove potential button underline */
    border-bottom-color: var(--color-primary);
}

.btn-like-link:active {
    color: var(--color-primary-dark);
}

/* Header transition states - simple fade to match main content */
.header-updating {
    opacity: 0;
}

/* Mobile Menu Toggle Button - Clear, accessible design */
.mobile-menu-toggle {
    display: none; /* Hidden by default */
    background: none;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius-sm);
    padding: var(--spacing-xs) var(--spacing-sm);
    cursor: pointer;
    color: var(--color-text);
    line-height: 1;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    margin-left: var(--spacing-sm);
}

.mobile-menu-toggle .icon {
    width: 1.5rem;
    height: 1.5rem;
}

.mobile-menu-toggle:hover {
    background-color: var(--color-light);
    color: var(--color-primary);
}

.mobile-menu-toggle:focus-visible {
    outline: 3px solid var(--color-focus-ring);
    outline-offset: 2px;
}

.app-header.mobile-menu-open .mobile-menu-toggle {
    color: var(--color-primary);
    border-color: var(--color-primary);
}

/* Mobile Menu Overlay - For closing the menu when clicking outside */
.mobile-menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 98; /* Below the menu but above everything else */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.app-header.mobile-menu-open + .mobile-menu-overlay {
    opacity: 1;
    visibility: visible;
}

/* Responsive Styles */
@media (max-width: 768px) { /* Adjust breakpoint as needed */
    /* Mobile navigation container - Side panel design */
    .header-navigation {
        position: fixed;
        top: 0;
        right: 0; /* Position on the right side */
        bottom: 0;
        width: 300px; /* Slightly wider for better readability */
        max-width: 85%; /* Responsive limit */
        background-color: var(--color-white);
        box-shadow: var(--box-shadow-lg);
        z-index: 99;
        overflow-y: auto; /* Allow scrolling if needed */
        transform: translateX(100%); /* Start off-screen */
        visibility: hidden; /* Hide from screen readers when closed */
        transition: transform 0.3s ease-in-out, visibility 0.3s ease-in-out;
        padding-top: var(--spacing-xl); /* Space at the top for close button */
        border-left: 1px solid var(--color-border);
    }

    .app-header.mobile-menu-open .header-navigation {
        transform: translateX(0); /* Slide in from the right */
        visibility: visible;
    }

    /* Close button inside the menu - Hidden by default for all views */
    .mobile-menu-close {
        display: none; /* Hide by default */
        position: absolute;
        top: var(--spacing-md);
        right: var(--spacing-md);
        background: none;
        border: 1px solid var(--color-border);
        border-radius: var(--border-radius-sm);
        color: var(--color-text-muted);
        cursor: pointer;
        padding: var(--spacing-xs);
        line-height: 1;
        z-index: 2;
        align-items: center;
        justify-content: center;
    }

    /* Always hide the close button by default */
    .mobile-menu-close {
        display: none;
    }

    /* Only show close button in mobile view when menu is open */
    @media (max-width: 768px) {
        .app-header.mobile-menu-open .mobile-menu-close {
            display: flex !important;
        }
    }

    /* Explicitly ensure it's hidden in desktop view */
    @media (min-width: 769px) {
        .mobile-menu-close {
            display: none !important;
        }
    }

    .mobile-menu-close .icon {
        width: 1.5rem;
        height: 1.5rem;
    }

    .mobile-menu-close:hover {
        color: var(--color-primary);
        border-color: var(--color-primary);
        background-color: var(--color-light);
    }

    .mobile-menu-close:focus-visible {
        outline: 3px solid var(--color-focus-ring);
        outline-offset: 2px;
    }

    /* Navigation links container */
    .header-navigation .nav-links {
        flex-direction: column;
        align-items: flex-start; /* Left-aligned for better readability */
        padding: var(--spacing-lg) var(--spacing-md);
        gap: var(--spacing-sm); /* Add some spacing between items */
        margin-top: var(--spacing-md); /* Add space at the top */
    }

    /* Individual navigation items */
    .header-navigation .nav-links li {
        width: 100%;
        margin: 0;
        border-radius: var(--border-radius-md);
        overflow: hidden; /* Keep the border-radius for hover states */
    }

    /* Add a subtle header to the mobile menu */
    .header-navigation::before {
        content: 'Menú';
        display: block;
        position: absolute;
        top: var(--spacing-md);
        left: var(--spacing-md);
        font-size: 1.2rem;
        font-weight: var(--font-weight-bold);
        color: var(--color-primary);
    }

    /* User greeting styling - More modern and welcoming */
    .nav-user-info {
        padding: var(--spacing-lg) var(--spacing-md) var(--spacing-md);
        font-size: 0.9rem;
        color: var(--color-text-muted);
        margin-bottom: var(--spacing-sm);
        text-align: left;
        background-color: rgba(var(--color-primary-rgb), 0.05);
        border-radius: var(--border-radius-md);
        position: relative;
    }

    .nav-user-info #user-name-display {
        font-size: 1.2rem;
        font-weight: var(--font-weight-bold);
        color: var(--color-primary);
        display: block;
        margin-top: var(--spacing-xs);
    }

    /* Add a subtle user icon */
    .nav-user-info::before {
        content: '';
        display: block;
        position: absolute;
        top: var(--spacing-md);
        right: var(--spacing-md);
        width: 24px;
        height: 24px;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23a72b31' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='12' cy='7' r='4'%3E%3C/circle%3E%3C/svg%3E");
        opacity: 0.5;
    }

    /* Navigation links styling - Modern, touch-friendly targets with icons */
    .header-navigation .nav-link,
    .header-navigation .btn-like-link {
        display: flex;
        align-items: center;
        padding: var(--spacing-md) var(--spacing-lg);
        color: var(--color-text);
        font-size: 1rem; /* Standard size for readability */
        font-weight: var(--font-weight-medium);
        transition: all 0.2s ease;
        text-align: left;
        width: 100%;
        border-radius: var(--border-radius-md);
        border-left: 3px solid transparent;
        position: relative;
    }

    .header-navigation .nav-link:hover,
    .header-navigation .btn-like-link:hover,
    .header-navigation .nav-link:focus,
    .header-navigation .btn-like-link:focus {
        background-color: rgba(var(--color-primary-rgb), 0.05);
        color: var(--color-primary);
        text-decoration: none !important; /* Force no underline */
        border-left-color: var(--color-primary);
        padding-left: calc(var(--spacing-lg) + 3px);
    }

    .header-navigation .nav-link.active {
        color: var(--color-primary);
        font-weight: var(--font-weight-bold);
        background-color: rgba(var(--color-primary-rgb), 0.08);
        border-left-color: var(--color-primary);
        padding-left: calc(var(--spacing-lg) + 3px);
        /* Mobile view uses left border instead of bottom border */
        border-bottom-color: transparent;
    }

    /* Add subtle animation for links */
    .header-navigation .nav-link::after,
    .header-navigation .btn-like-link::after {
        content: '→';
        position: absolute;
        right: var(--spacing-md);
        opacity: 0;
        transform: translateX(-10px);
        transition: all 0.2s ease;
    }

    .header-navigation .nav-link:hover::after,
    .header-navigation .btn-like-link:hover::after,
    .header-navigation .nav-link:focus::after,
    .header-navigation .btn-like-link:focus::after,
    .header-navigation .nav-link.active::after {
        opacity: 1;
        transform: translateX(0);
    }

    /* Button styling in mobile menu - Clear, consistent with brand */
    .header-navigation .btn-small {
        margin: var(--spacing-md) var(--spacing-lg);
        width: calc(100% - var(--spacing-lg) * 2);
        text-align: center;
        padding: var(--spacing-md);
        /* All other styles inherit from global .btn styles */
    }

    /* Active state for buttons in mobile view */
    .header-navigation .btn.active-btn {
        /* No additional styles needed - inherits from global .btn-primary */
    }

    /* Logout button styling - Distinctive and attention-grabbing */
    #header-logout-btn {
        text-align: left;
        color: var(--color-danger); /* Use danger color for logout */
        margin-top: var(--spacing-xl);
        border-radius: var(--border-radius-md);
        border: 1px solid rgba(var(--color-danger-rgb), 0.2);
        background-color: rgba(var(--color-danger-rgb), 0.03);
        position: relative;
        padding-left: calc(var(--spacing-lg) + 24px);
    }

    #header-logout-btn::before {
        content: '';
        position: absolute;
        left: var(--spacing-md);
        top: 50%;
        transform: translateY(-50%);
        width: 18px;
        height: 18px;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23dc3545' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4'%3E%3C/path%3E%3Cpolyline points='16 17 21 12 16 7'%3E%3C/polyline%3E%3Cline x1='21' y1='12' x2='9' y2='12'%3E%3C/line%3E%3C/svg%3E");
    }

    #header-logout-btn:hover,
    #header-logout-btn:focus {
        background-color: rgba(var(--color-danger-rgb), 0.08);
        border-color: rgba(var(--color-danger-rgb), 0.4);
    }

    #header-logout-btn::after {
        content: none; /* Remove the arrow for logout button */
    }

    /* Show mobile menu toggle button */
    .mobile-menu-toggle {
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    /* Prevent body scrolling when menu is open */
    body.mobile-menu-open {
        overflow: hidden;
    }

    /* Ensure proper focus management */
    .header-navigation:focus {
        outline: none;
    }

    /* Respect reduced motion preferences */
    @media (prefers-reduced-motion: reduce) {
        .header-navigation,
        .mobile-menu-overlay,
        .mobile-menu-toggle,
        .header-navigation .nav-link,
        .header-navigation .btn-like-link {
            transition: none;
        }
    }
}
